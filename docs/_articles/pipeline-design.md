---
layout: article
title: "Astrophotography Pipelines"
date: 2026-01-14 14:30:00 +0000
series: "Design"
series_order: 1
categories: astrophotography pipelines image-processing design
published: true
usemathjax: true
---
This article dives into the design philosophy behind AstrophotoKit's pipeline system, showing you how we've built a flexible, reusable framework for astrophotography processing. While AstrophotoKit is being developed, this will represent our intentions and may not represent the current state of functionality. It is a design document after all.

## Terminology

Before we dive in, let's establish some key terminology. We'll use the word **frame** to refer to any single image, whether it's captured directly by your camera, generated by a processing step, or even a calibration frame like dark or bias frames. An **astrophoto**, on the other hand, is the final result of carefully orchestrated operations on one or more frames. Think of frames as the raw materials and an astrophoto as the finished artwork.

A **pipeline** is essentially a recipe for processing your data. It consists of a series of **processing steps** that can run sequentially or in parallel, each taking input data and transforming it into something new. What makes pipelines powerful is their flexibility: each step can expose configurable parameters, allowing you to fine-tune the processing to match your specific needs. While frames are the most common input type, pipelines can also work with tables, matrices, or any other structured data.

## Real-World Examples

One example pipeline performs calibration of light frames by combining them with dark frames, bias frames, flat frames, and dark flat frames to reduce noise and systematic artifacts.

Another example pipeline implements star detection through a sequence of image processing operations: Gaussian blur filtering, background subtraction, thresholding, and morphological operations (binary erosion followed by binary dilation) to identify and isolate stellar sources.

Pipelines are reusable across multiple frames, enabling consistent processing workflows and parameter configurations.

## Configuring Pipelines

A pipeline consists of a sequence of processing steps, where each step applies a transformation (implemented either in AstrophotoKit core or via a plugin) to its input data and produces output data. The output from one step serves as input to subsequent steps in the pipeline.

To enable data reuse and proper tracking, each data object must maintain metadata describing its processing history. For example, if a step applies a Gaussian blur filter to an input image, the output image must record that a Gaussian blur operation has been applied. This processing history allows the system to understand the state and provenance of data as it flows through the pipeline.

Within a pipeline definition, the data flow between steps is explicitly specified: each step declares which outputs from previous steps serve as its inputs, and how those inputs map to the step's parameters. For example, in a star detection pipeline, the first step applies a Gaussian blur to the input frame. The blurred frame output from this step is then explicitly designated as the input to the next step, which computes the local median within a 50Ã—50 pixel window to generate a background estimation frame (representing the frame without stellar sources).

The configuration of a pipeline should be separate from the code. In AstophotoKit, pipeline configuration is defined in YAML files.

* steps should be able to use metal shaders or swift code depending on whether GPU or CPU should be used
* frames are represented by Metal textures, as they will most commonly be used in GPU tasks